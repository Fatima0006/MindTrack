<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MindTrack</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap');
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Poppins', sans-serif; display: flex; min-height: 100vh; background-color: #f9f9fb; flex-direction: column; }

.sidebar { width: 250px; background-color: #ffffff; border-right: 3px solid #24345c; transition: width 0.3s; overflow: hidden; display: flex; flex-direction: column; position: fixed; top: 0; left: 0; bottom: 0; }
.sidebar.collapsed { width: 70px; }
.sidebar .logo { display: flex; align-items: center; justify-content: center; gap: 10px; padding: 20px; font-size: 20px; font-weight: 600; color: #24345c; border-bottom: 2px solid #24345c; }
.logo-img { width: 50px; height: 50px; object-fit: contain; }
.sidebar ul { list-style: none; margin-top: 20px; flex: 1; }
.sidebar ul li { padding: 15px 20px; display: flex; align-items: center; cursor: pointer; transition: all 0.3s ease; color: #24345c; font-weight: 500; }
.sidebar ul li:hover { background-color: rgba(225, 129, 37, 0.15); border-left: 4px solid #e18125; }
.sidebar ul li i { font-size: 20px; color: #e18125; margin-right: 15px; width: 25px; text-align: center; }
.sidebar ul li span { white-space: nowrap; }
.sidebar.collapsed ul li span { display: none; }

.main { margin-left: 250px; flex: 1; display: flex; flex-direction: column; min-height: 100vh; transition: margin-left 0.3s; }
.sidebar.collapsed ~ .main { margin-left: 70px; }

header { background-color: #ffffff; border-bottom: 3px solid #24345c; padding: 15px 25px; display: flex; align-items: center; box-shadow: 0 2px 8px rgba(36, 52, 92, 0.1); justify-content: space-between; }
header .menu-toggle { font-size: 26px; color: #24345c; cursor: pointer; transition: color 0.3s; }
header .menu-toggle:hover { color: #e18125; }
header .user-info span { font-size: 20px; font-weight: 600; color:#24345c; }

.content { padding: 30px; flex: 1; overflow-y: auto; background-color: #ffffff; }
h2.section-title { color: #24345c; margin: 25px 0 15px; cursor:pointer; font-weight: 600; font-size:24px; display:flex; justify-content: space-between; align-items:center; }
.cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; margin-top: 10px; }
.card { background: white; border-radius: 15px; padding: 25px; border: 2px solid #24345c; box-shadow: 0 4px 12px rgba(36, 52, 92, 0.1); transition: all 0.3s ease; text-align: center; }
.card:hover { transform: translateY(-8px); border-color: #e18125; box-shadow: 0 8px 20px rgba(36, 52, 92, 0.2); }
.card h3 { color: #24345c; margin-bottom: 10px; font-size: 18px; font-weight: 600; }
.card p, .card input, .card select { color: #444; font-size: 16px; margin:5px 0; width:100%; border:none; text-align:center; background:none; }
.card input { border-bottom:1px solid #ccc; padding:4px; }
.card button { margin-top:10px; padding:6px 14px; font-size:14px; background:#e18125; color:white; border:none; border-radius:8px; cursor:pointer; }
.card button:hover { background:#cf731c; }
.card .btn-delete { background:#b93030; margin-left:5px; }
.card .btn-delete:hover { background:#982525; }

.add-btn { background:#2ecc71; color:white; border:none; padding:5px 10px; border-radius:6px; cursor:pointer; font-size:14px; margin-left:10px;}
.add-btn:hover { background:#27ae60; }

canvas { width: 100% !important; height: 200px !important; }

footer { border-top:3px solid #24345c; background:#fff; color:#24345c; padding:40px 20px 20px; text-align:center; margin-top:40px; }
footer .container { max-width:1000px; margin:auto; }
footer .row { display:flex; flex-wrap:wrap; justify-content:space-between; gap:30px; }
footer h5 { color:#24345c; margin-bottom:10px; }
footer a { color:#24345c; text-decoration:none; }
footer a:hover { color:#e18125; }

.modal { display: none; position: fixed; z-index: 200; left: 0; top: 0; width: 100%; height: 100%; background: rgba(36, 52, 92, 0.6); justify-content: center; align-items: center; }
.modal-content { background: #fff; border: 2px solid #24345c; border-radius: 12px; padding: 30px; text-align: center; max-width: 400px; width: 90%; box-shadow: 0 6px 20px rgba(0,0,0,0.25); }
.modal-logo { width: 60px; height: 60px; object-fit: contain; margin-bottom: 15px; }
.modal-content h3 { color: #24345c; margin-bottom: 10px; }
.modal-content p { color: #555; font-size: 15px; margin-bottom: 25px; }
.modal-buttons { display: flex; justify-content: center; gap: 15px; }
.btn-confirm, .btn-cancel { padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: 500; border:none; }
.btn-confirm { background-color: #e18125; color:white; }
.btn-cancel { background-color: #24345c; color:white; }

@media (max-width: 768px) {
  .sidebar { position: absolute; z-index: 100; left: -250px; }
  .sidebar.collapsed { left: 0; width: 250px; }
  .main { margin-left: 0; }
}
</style>
</head>
<body>

<aside class="sidebar" id="sidebar">
  <div class="logo">
    <img src="img/logo.jpg" alt="MindTrack Logo" class="logo-img">
    <span>MindTrack</span>
  </div>
  <ul>
    <li data-href="admin-dashboard.html"><i>üè†</i><span>Inicio</span></li>
    <li data-href="users.html"><i>üë•</i><span>Usuarios</span></li>
    <li id="logoutSidebar"><i>üö™</i><span>Cerrar sesi√≥n</span></li>
  </ul>
</aside>

<div class="main">
  <header>
    <div class="menu-toggle" id="menuToggle">‚ò∞</div>
    <div class="user-info"><span id="user-display"></span></div>
  </header>
  
  <div class="content" id="content">
    <h2>Panel de Administraci√≥n</h2>

    <h2 class="section-title">
      üß† Ejercicios Disponibles
      <button class="add-btn" onclick="addEmptyCard('exercise')">+ Agregar</button>
    </h2>
    <div class="cards" id="exercisesContainer"></div>

    <h2 class="section-title">
      üìÜ Sesiones Recientes
      <button class="add-btn" onclick="addEmptyCard('session')">+ Agregar</button>
    </h2>
    <div class="cards" id="sessionsContainer"></div>
  </div>

  <footer class="text-dark pt-5 pb-3">
    <div class="container">
      <div class="row">
        <div class="col-lg-6 mb-3">
          <h5>MindTrack</h5>
          <p>Tu aliado en bienestar emocional y desarrollo cognitivo.</p>
        </div>
        <div class="col-lg-3 mb-3">
          <h5>Enlaces</h5>
          <ul class="list-unstyled footer-links">
            <li><a href="admin-dashboard.html">Inicio</a></li>
            <li><a href="users.html">Usuarios</a></li>
          </ul>
        </div>
        <div class="col-lg-3 mb-3">
          <h5>Contacto</h5>
          <p><i class="fa fa-phone-alt mr-2"></i>+52 8123456789</p>
          <p><i class="fa fa-envelope mr-2"></i>contact@mindtrack.com</p>
        </div>
      </div>
      <div class="text-center mt-3">&copy; 2025 MindTrack. Todos los derechos reservados.</div>
    </div>
  </footer>
</div>

<script>
const sidebar = document.getElementById('sidebar');
document.getElementById('menuToggle').addEventListener('click', ()=> sidebar.classList.toggle('collapsed'));

const username = localStorage.getItem("username");
if(username){ document.getElementById("user-display").textContent = username; } 
else { window.location.href='index.html'; }

document.querySelectorAll('ul li[data-href]').forEach(item=>{
  item.addEventListener('click', ()=> window.location.href=item.getAttribute('data-href'));
});

let exercises = [
  {name:"Memoria Visual", duration:"10", level:"B√°sico", objective:"Mejorar memoria y concentraci√≥n"},
  {name:"Razonamiento L√≥gico", duration:"15", level:"Intermedio", objective:"Desarrollar habilidades de l√≥gica"},
  {name:"Atenci√≥n Sostenida", duration:"12", level:"B√°sico", objective:"Mejorar la concentraci√≥n y foco"}
];

let sessions = [
  {name:"Sesi√≥n Matutina", date:"2025-10-20", duration:"25", exercises:"Memoria Visual, Atenci√≥n Sostenida", result:"85% aciertos"},
  {name:"Sesi√≥n Tarde", date:"2025-10-19", duration:"30", exercises:"Razonamiento L√≥gico, Memoria Visual", result:"90% aciertos"}
];

function renderExercises(){
  const container = document.getElementById("exercisesContainer");
  container.innerHTML="";
  exercises.forEach((ex,index)=>{
    const card = document.createElement("div");
    card.classList.add("card");
    
    const levelField = ex.name === "" 
      ? `<select>
          <option value="B√°sico">B√°sico</option>
          <option value="Intermedio">Intermedio</option>
          <option value="Avanzado">Avanzado</option>
         </select>`
      : `<input value="${ex.level}" disabled>`;
    
    card.innerHTML = `
      <input value="${ex.name}" placeholder="Nombre" ${ex.name? 'disabled' : ''}>
      <input type="number" value="${ex.duration}" placeholder="Duraci√≥n (min)" ${ex.duration? 'disabled' : ''} max="15">
      ${levelField}
      <input value="${ex.objective}" placeholder="Objetivo" ${ex.objective? 'disabled' : ''}>
      <div>
        <button onclick="editExercise(${index}, this)">‚úèÔ∏è ${ex.name? 'Editar' : 'Guardar'}</button>
        <button class="btn-delete" onclick="deleteExercise(${index})">üóëÔ∏è Eliminar</button>
      </div>`;
    container.appendChild(card);
  });
}

function renderSessions(){
  const container = document.getElementById("sessionsContainer");
  container.innerHTML="";
  const today = new Date().toISOString().split('T')[0];
  sessions.forEach((s,index)=>{
    const card = document.createElement("div");
    card.classList.add("card");
    card.innerHTML=`
      <input value="${s.name}" placeholder="Nombre" ${s.name? 'disabled':''}>
      <input type="date" value="${s.date}" placeholder="Fecha" ${s.date? 'disabled':''} min="${today}">
      <input type="number" value="${s.duration}" placeholder="Duraci√≥n (min)" ${s.duration? 'disabled':''} max="15">
      <input value="${s.exercises}" placeholder="Ejercicios" ${s.exercises? 'disabled':''}>
      <input value="${s.result}" placeholder="Resultado" disabled>
      <div>
        <button onclick="editSession(${index}, this)">‚úèÔ∏è ${s.name? 'Editar' : 'Guardar'}</button>
        <button class="btn-delete" onclick="deleteSession(${index})">üóëÔ∏è Eliminar</button>
      </div>`;
    container.appendChild(card);
  });
}

function editExercise(index, btn){
  const card = btn.closest(".card");
  const inputs = card.querySelectorAll("input, select");
  if(btn.textContent.includes("Editar") || btn.textContent.includes("Guardar")){
    if(btn.textContent.includes("Editar")){
      inputs.forEach(i=> i.disabled=false);
      btn.textContent="üíæ Guardar";
    } else {
      const dur = parseInt(inputs[1].value);
      if(dur>15){ alert("La duraci√≥n m√°xima es 15 minutos."); return; }
      exercises[index] = {
        name: inputs[0].value,
        duration: inputs[1].value,
        level: inputs[2].tagName==="SELECT"?inputs[2].value:inputs[2].value,
        objective: inputs[3].value
      };
      inputs.forEach(i=> i.disabled=true);
      btn.textContent="‚úèÔ∏è Editar";
    }
  }
}

function editSession(index, btn){
  const card = btn.closest(".card");
  const inputs = card.querySelectorAll("input");
  const today = new Date().toISOString().split('T')[0];
  if(btn.textContent.includes("Editar") || btn.textContent.includes("Guardar")){
    if(btn.textContent.includes("Editar")){
      inputs.forEach(i=> { if(i.placeholder!=="Resultado") i.disabled=false });
      btn.textContent="üíæ Guardar";
    } else {
      if(parseInt(inputs[2].value)>15){ alert("La duraci√≥n m√°xima es 15 minutos."); return; }
      if(inputs[1].value<today){ alert("La fecha no puede ser anterior a hoy."); return; }
      sessions[index] = {
        name: inputs[0].value,
        date: inputs[1].value,
        duration: inputs[2].value,
        exercises: inputs[3].value,
        result: inputs[4].value
      };
      inputs.forEach(i=> i.disabled=true);
      btn.textContent="‚úèÔ∏è Editar";
    }
  }
}

function deleteExercise(index){ if(confirm("¬øDeseas eliminar este ejercicio?")){ exercises.splice(index,1); renderExercises(); } }
function deleteSession(index){ if(confirm("¬øDeseas eliminar esta sesi√≥n?")){ sessions.splice(index,1); renderSessions(); } }

function addEmptyCard(section){
  if(section==='exercise'){
    exercises.push({name:"",duration:"",level:"B√°sico",objective:""});
    renderExercises();
    const container = document.getElementById("exercisesContainer");
    const lastCard = container.lastElementChild;
    lastCard.querySelectorAll("input, select").forEach(i=> i.disabled=false);
    lastCard.querySelector("button").textContent="üíæ Guardar";
  } else {
    const today = new Date().toISOString().split('T')[0];
    sessions.push({name:"",date:today,duration:"",exercises:"",result:"Pendiente"});
    renderSessions();
    const container = document.getElementById("sessionsContainer");
    const lastCard = container.lastElementChild;
    lastCard.querySelectorAll("input").forEach(i=> { if(i.placeholder!=="Resultado") i.disabled=false });
    lastCard.querySelector("button").textContent="üíæ Guardar";
  }
}

document.addEventListener("DOMContentLoaded", ()=>{
  renderExercises();
  renderSessions();
});

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./serviceWorker.js')
    .then(() => console.log('Service Worker registrado.'))
    .catch(err => console.error('Error registrando SW:', err));
}
logoutSidebar.addEventListener("click", () => {
  if(confirm("¬øDeseas cerrar sesi√≥n?")){
    localStorage.removeItem("username");
    window.location.href = "index.html";
  }
});

</script>

</body>
</html>
